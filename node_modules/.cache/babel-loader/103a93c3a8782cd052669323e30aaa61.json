{"ast":null,"code":"import { useState, useEffect } from 'react';\n\nfunction decodeToken(token) {\n  try {\n    if (token.split(\".\").length !== 3 || typeof token !== \"string\") {\n      return null;\n    } else {\n      var payload = token.split(\".\")[1];\n      var base64 = payload.replace(\"-\", \"+\").replace(\"_\", \"/\");\n      var decoded = JSON.parse(atob(base64));\n      return decoded;\n    }\n  } catch (error) {\n    return null;\n  }\n}\n\nfunction isTokenExpired(token) {\n  var decodedToken = decodeToken(token);\n  var result = true;\n\n  if (decodedToken && decodedToken.exp) {\n    var expirationDate = new Date(0);\n    expirationDate.setUTCSeconds(decodedToken.exp);\n    result = expirationDate.valueOf() < new Date().valueOf();\n  } else {\n    result = true;\n  }\n\n  return result;\n}\n\nfunction useJwt(userJwt) {\n  var _useState = useState(false),\n      isExpired = _useState[0],\n      setIsExpired = _useState[1];\n\n  var _useState2 = useState(null),\n      decodedToken = _useState2[0],\n      setDecodedToken = _useState2[1];\n\n  useEffect(function () {\n    evaluateToken(userJwt);\n  }, [userJwt]);\n\n  var evaluateToken = function evaluateToken(token) {\n    setDecodedToken(decodeToken(token));\n    setIsExpired(isTokenExpired(token));\n  };\n\n  return {\n    isExpired: isExpired,\n    decodedToken: decodedToken,\n    reEvaluateToken: evaluateToken\n  };\n}\n\nexport { decodeToken, isTokenExpired as isExpired, useJwt };","map":{"version":3,"sources":["../src/jwt/index.ts","../src/hooks/index.tsx"],"names":["decodeToken","token","payload","base64","decoded","JSON","atob","isTokenExpired","decodedToken","result","expirationDate","useJwt","userJwt","isExpired","setIsExpired","useState","setDecodedToken","useEffect","evaluateToken","reEvaluateToken"],"mappings":";;SAAgBA,W,CAAYC,K,EAAAA;AAC1B,MAAI;AAGF,QAAIA,KAAK,CAALA,KAAAA,CAAAA,GAAAA,EAAAA,MAAAA,KAAAA,CAAAA,IAAiC,OAAA,KAAA,KAArC,QAAA,EAAgE;AAC9D,aAAA,IAAA;AADF,KAAA,MAEO;AAGL,UAAMC,OAAO,GAAWD,KAAK,CAALA,KAAAA,CAAAA,GAAAA,EAAxB,CAAwBA,CAAxB;AAEA,UAAME,MAAM,GAAWD,OAAO,CAAPA,OAAAA,CAAAA,GAAAA,EAAAA,GAAAA,EAAAA,OAAAA,CAAAA,GAAAA,EAAvB,GAAuBA,CAAvB;AAEA,UAAME,OAAO,GAAGC,IAAI,CAAJA,KAAAA,CAAWC,IAAI,CAA/B,MAA+B,CAAfD,CAAhB;AACA,aAAA,OAAA;AACD;AAdH,GAAA,CAeE,OAAA,KAAA,EAAc;AAEd,WAAA,IAAA;AACD;AACF;;SAEeE,c,CAAeN,K,EAAAA;AAC7B,MAAMO,YAAY,GAAQR,WAAW,CAArC,KAAqC,CAArC;AACA,MAAIS,MAAM,GAAV,IAAA;;AAEA,MAAID,YAAY,IAAIA,YAAY,CAAhC,GAAA,EAAsC;AACpC,QAAME,cAAc,GAAS,IAAA,IAAA,CAA7B,CAA6B,CAA7B;AACAA,IAAAA,cAAc,CAAdA,aAAAA,CAA6BF,YAAY,CAAzCE,GAAAA;AAEAD,IAAAA,MAAM,GAAGC,cAAc,CAAdA,OAAAA,KAA2B,IAAA,IAAA,GAApCD,OAAoC,EAApCA;AAJF,GAAA,MAKO;AACLA,IAAAA,MAAM,GAANA,IAAAA;AACD;;AAED,SAAA,MAAA;AACD;;SCjCeE,M,CAAOC,O,EAAAA;kBACaG,QAAQ,CAAA,KAAA,C;MAAnCF,SAAAA,GAAAA,SAAAA,CAAAA,CAAAA,C;MAAWC,YAAAA,GAAAA,SAAAA,CAAAA,CAAAA,C;;mBACsBC,QAAQ,CAAA,IAAA,C;MAAzCP,YAAAA,GAAAA,UAAAA,CAAAA,CAAAA,C;MAAcQ,eAAAA,GAAAA,UAAAA,CAAAA,CAAAA,C;;AAErBC,EAAAA,SAAS,CAAC,YAAA;AACRC,IAAAA,aAAa,CAAbA,OAAa,CAAbA;AADO,GAAA,EAEN,CAFHD,OAEG,CAFM,CAATA;;AAIA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAA,KAAA,EAAA;AACpBF,IAAAA,eAAe,CAAChB,WAAW,CAA3BgB,KAA2B,CAAZ,CAAfA;AACAF,IAAAA,YAAY,CAACP,cAAc,CAA3BO,KAA2B,CAAf,CAAZA;AAFF,GAAA;;AAKA,SAAO;AAAED,IAAAA,SAAS,EAAX,SAAA;AAAaL,IAAAA,YAAY,EAAzB,YAAA;AAA2BW,IAAAA,eAAe,EAAED;AAA5C,GAAP;AACD","sourcesContent":["export function decodeToken(token: string) {\n  try {\n    // if the token has more or less than 3 parts or is not a string\n    // then is not a valid token\n    if (token.split(\".\").length !== 3 || typeof token !== \"string\") {\n      return null;\n    } else {\n      // payload ( index 1 ) has the data stored and\n      // data about the expiration time\n      const payload: string = token.split(\".\")[1];\n      // handle unicode parsing issues between atob and JWT base64 format\n      const base64: string = payload.replace(\"-\", \"+\").replace(\"_\", \"/\");\n      // decode and parse to json\n      const decoded = JSON.parse(atob(base64));\n      return decoded;\n    }\n  } catch (error) {\n    // Return null if something goes wrong\n    return null;\n  }\n}\n\nexport function isTokenExpired(token: string) {\n  const decodedToken: any = decodeToken(token);\n  let result: boolean = true;\n\n  if (decodedToken && decodedToken.exp) {\n    const expirationDate: Date = new Date(0);\n    expirationDate.setUTCSeconds(decodedToken.exp); // sets the expiration seconds\n    // compare the expiration time and the current time\n    result = expirationDate.valueOf() < new Date().valueOf();\n  } else {\n    result = true;\n  }\n\n  return result;\n}\n","import { useState, useEffect } from \"react\";\nimport { decodeToken, isTokenExpired } from \"../jwt\";\n\nexport function useJwt(userJwt: string) {\n  const [isExpired, setIsExpired] = useState<boolean>(false);\n  const [decodedToken, setDecodedToken] = useState<any>(null);\n\n  useEffect(() => {\n    evaluateToken(userJwt);\n  }, [userJwt]);\n\n  const evaluateToken = (token: string) => {\n    setDecodedToken(decodeToken(token));\n    setIsExpired(isTokenExpired(token));\n  };\n\n  return { isExpired, decodedToken, reEvaluateToken: evaluateToken };\n}\n"]},"metadata":{},"sourceType":"module"}