{"ast":null,"code":"var _jsxFileName = \"/Users/mohammedshafeeq/Downloads/Shareup-Project-main/Shareup-react/shareup-react/src/components/Hang/ShippingComponent.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext, useCallback, useRef } from 'react';\nimport { Redirect, useHistory } from \"react-router-dom\";\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport UserService from '../../services/UserService';\nimport UserContext from '../../contexts/UserContext';\nimport PostService from '../../services/PostService';\nimport AuthService from '../../services/auth.services';\nimport SimpleReactLightbox from 'simple-react-lightbox';\nimport { testScript } from '../../js/script';\nimport GoogleMapReact from 'google-map-react';\nimport EditPostComponent from '../post/EditPostComponent';\nimport Layout from '../LayoutComponent';\nimport PostComponent from '../post/PostComponent';\nimport Popup from 'reactjs-popup';\nimport PhoneInput from 'react-phone-number-input';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ShippingComponent(props) {\n  _s();\n\n  const [isLoading, setIsLoading] = useState(true);\n  let history = useHistory();\n  const {\n    user\n  } = useContext(UserContext); // const []\n  // const inputRef = createRef();\n\n  const [refresh, setRefresh] = useState(null);\n  const [showComp, setShowComp] = useState(\"newsfeed\");\n  const [showLoc, setShowLoc] = useState(\"yes\");\n  const [posts, setPosts] = useState([]);\n  const [postsForUser, setPostsForUser] = useState([]);\n  const [savedPost, setSavedPost] = useState([]);\n  const [userR, setUserR] = useState([]);\n  const refMap = useRef(null);\n  const [postContent, setPostContent] = useState(\"\");\n  const [commentContent, setCommentContent] = useState(\"\");\n  const [files, setFiles] = useState({});\n  const [postImage, setPostImage] = useState({});\n  const [showPostImage, setShowPostImage] = useState(false);\n  const [uploadError, setUploadError] = useState(\"\");\n  const [editPostId, setEditPostId] = useState(null);\n  const [img, setImage] = useState(\"\");\n  const [value, setValue] = useState();\n  const defaultProps = {\n    center: {\n      lat: 10.99835602,\n      lng: 77.01502627\n    },\n    zoom: 11\n  }; // const [cursorPosition, setCursorPosition] = useState();\n  // const pickEmoji = (e, {emoji}) => {\n  //   const ref = inputRef.current;\n  //   ref.focus();\n  //   const start = commentContent.substring(0, ref.seletionStart);\n  //   const end = commentContent.substring(ref.selectionStart);\n  //   const text = start + emoji + end;\n  //   setCommentContent(text)\n  //   setCursorPosition(start.length+emoji.length)\n  // }\n  // useEffect(() => {\n  //   inputRef.current.selectionEnd = cursorPosition;\n  // },[cursorPosition])\n\n  const AnyReactComponent = ({\n    text\n  }) => /*#__PURE__*/_jsxDEV(\"div\", {\n    children: text\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 43\n  }, this);\n\n  const getPost = async () => {\n    await PostService.getPost().then(res => {\n      setPosts(res.data);\n    });\n  };\n\n  const getPostForUser = async () => {\n    await PostService.getPostForUser(AuthService.getCurrentUser().username).then(res => {\n      const uniquePost = Array.from(new Set(res.data.map(a => a.id))).map(id => {\n        return res.data.find(a => a.id === id);\n      });\n      setPostsForUser(uniquePost);\n    });\n  };\n\n  const getSavedPost = async () => {\n    await PostService.getSavedPostForUser(AuthService.getCurrentUser().username).then(res => {\n      setSavedPost(res.data);\n    });\n  };\n\n  const handlePostContent = event => {\n    console.log(event.target.value);\n    setPostContent(event.target.value);\n  };\n\n  const handleDeletePost = postid => {\n    PostService.deletePost(postid).then(res => {\n      console.log(res.status);\n      setRefresh(res.data); // window.location.reload();\n    });\n  };\n\n  const handleCommentContent = event => {\n    console.log(event.target.value);\n    setCommentContent(event.target.value);\n  };\n\n  const handlePostingComment = postid => {\n    if (commentContent === \"\") {\n      return null;\n    }\n\n    const comment = {\n      content: commentContent\n    };\n    PostService.addComment(user.id, postid, comment).then(res => {\n      console.log(res.status);\n      setRefresh(res.data);\n      setCommentContent(\"\");\n    });\n  };\n\n  const handleEditPost = id => {\n    setEditPostId(id);\n  };\n\n  const handleFile = event => {\n    console.log(event.target.files[0]);\n    setFiles(event.target.files[0]);\n    const reader = new FileReader();\n\n    reader.onload = () => {\n      if (reader.readyState === 2) {\n        setPostImage(reader.result);\n      }\n    };\n\n    console.log(event.target.files[0]); // if(event.target.files[0].type === blob){\n\n    reader.readAsDataURL(event.target.files[0]); // }\n\n    setShowPostImage(true);\n  };\n\n  const handleRemoveImage = () => {\n    setFiles({});\n    setShowPostImage(false);\n  };\n\n  const handleEditingSave = value => {\n    setEditPostId(value); // console.log(res.status)\n    // window.location.reload();\n  };\n\n  const checkIfLiked = post => {\n    // maybe this is more effecient\n    // post.reactions.map(r => {\n    //   console.log(JSON.stringify(r.user))\n    //   if(r.user.id === user.id){\n    //     return true\n    //   }else{\n    //     return false\n    //   }\n    // })\n    const result = post.reactions.filter(reaction => reaction.user.id == userR.id);\n\n    if (result.length > 0) {\n      return true;\n    }\n\n    return false;\n  };\n\n  const checkIfSaved = post => {\n    console.log(post.savedByUsers); // maybe this is more effecient\n    // post.savedByUsers.map(r => {\n    //   console.log(\"runninggg\")\n    //   console.log(JSON.stringify(r.user) + \" i p pp p p\")\n    // if(r.user.id === user.id){\n    //   return true\n    // }else{\n    //   return false\n    // }\n    // })\n\n    console.log(post.savedByUsers.length + \" yaa\");\n    const result = post.savedByUsers.filter(userz => userz.id == user.id);\n\n    if (result.length > 0) {\n      console.log(\" FOUND\");\n      return true;\n    }\n\n    console.log(\" Not found\");\n    return false;\n  };\n\n  const handleDeleteComment = commentid => {\n    PostService.deleteComment(commentid).then(res => {\n      console.log(res.status);\n      setRefresh(res.data);\n    });\n  };\n\n  const getCommentCounter = comments => {\n    let counter = 0;\n    comments.map(comment => {\n      counter += comment.replies.length + 1;\n    });\n    return counter;\n  };\n\n  const uploadPost = event => {\n    event.preventDefault();\n    setUploadError(\"\");\n    console.log(\"uploading post working\");\n\n    if (postContent === \"\" && Object.keys(files).length === 0 && files.constructor === Object) {\n      console.log(\"cant be null\");\n      setUploadError(\"Please Insert A Text or an Image\");\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('content', postContent);\n    console.log(\" this is the files\" + files);\n    formData.append(`files`, files);\n    PostService.createPost(user.id, formData).then(res => {\n      console.log(JSON.stringify(res));\n      setPostContent(\"\");\n      handleRemoveImage();\n      setRefresh(res.data);\n    });\n  };\n\n  const handleLikePost = async post_id => {\n    UserService.likePost(user.id, post_id).then(res => {\n      setRefresh(res.data);\n    });\n  };\n\n  const handleSavePost = async post_id => {\n    UserService.savePost(user.id, post_id).then(res => {\n      setRefresh(res.data);\n    });\n  };\n\n  const getUser = async () => {\n    if (user === null) {\n      console.log(\"RUNNING\");\n      await UserService.getUserByEmail(AuthService.getCurrentUser().username).then(res => {\n        setUserR(res.data);\n      });\n    } else {\n      console.log(\"WALKING\" + JSON.stringify(user));\n      setUserR(user);\n    }\n  };\n\n  const testFanc = post => {\n    return /*#__PURE__*/_jsxDEV(PostComponent, {\n      post: post,\n      setRefresh: setRefresh\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 14\n    }, this);\n  };\n\n  const showMap = () => {\n    if (showLoc === \"yes\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: '50vh',\n          width: '100%'\n        },\n        children: /*#__PURE__*/_jsxDEV(GoogleMapReact, {\n          bootstrapURLKeys: {\n            key: \"AIzaSyCUqRf-EB8vo-P_BYx0dRES5A3h78u1Xzc\"\n          },\n          defaultCenter: defaultProps.center,\n          defaultZoom: defaultProps.zoom,\n          children: /*#__PURE__*/_jsxDEV(AnyReactComponent, {\n            lat: 59.955413,\n            lng: 30.337844,\n            text: \"My Marker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 1\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 7\n      }, this);\n    }\n  };\n\n  const show = () => {\n    if (showComp === \"newsfeed\") {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loadMore\",\n        children: postsForUser.map(post => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: post.group ? post.group.members.some(member => member.email === AuthService.getCurrentUser().username) ? testFanc(post) : null : testFanc(post)\n        }, post.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loadMore\",\n        children: savedPost.map(post => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: post.group ? post.group.members.some(member => member.email === AuthService.getCurrentUser().username) ? testFanc(post) : null : testFanc(post)\n        }, post.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this);\n    }\n  }; //   useEffect(()=>{\n  //     refMap.current.map.panTo(props.location)\n  // },[props.location])\n\n\n  useEffect(() => {\n    getUser();\n    getPost().then(() => {\n      setIsLoading(false);\n    });\n    getPostForUser();\n    getSavedPost();\n    testScript();\n  }, [editPostId, refresh]);\n  useEffect(() => {\n    getPostForUser();\n    getSavedPost();\n    testScript();\n  }, [user]);\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(function (position) {\n      console.log(\"Latitude is :\", position.coords.latitude);\n      console.log(\"Longitude is :\", position.coords.longitude);\n    });\n  });\n\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading... Please Wait\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 12\n    }, this);\n  } // const handleBoundsChanged = () => {\n  //   if (refMap.current) {\n  //       const mapCenter = {\n  //           lat: refMap.current.map.center.lat(),\n  //           lng: refMap.current.map.center.lng()\n  //       }\n  //       setListing({...listing, latLng: mapCenter})\n  //   }\n  // };\n\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    user: user,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-lg-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"central-meta newsfeed metaSip\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"new-postbox shipping\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"Location\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"newpst-input\",\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Please provide your location\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 1\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                style: {\n                  fontSize: '12px'\n                },\n                children: \"So that we can deliver this item to your doorstep\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 388,\n                columnNumber: 1\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Share your location via google maps\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 1\n              }, this), showMap(), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"phno\",\n                children: /*#__PURE__*/_jsxDEV(PhoneInput, {\n                  placeholder: \"Enter phone number\",\n                  value: value,\n                  onChange: setValue\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 400,\n                  columnNumber: 1\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 1\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  textAlign: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(Popup, {\n                  trigger: /*#__PURE__*/_jsxDEV(\"a\", {\n                    href: \"#\",\n                    className: \"buttonShip\",\n                    children: \"Let's Care it\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 406,\n                    columnNumber: 19\n                  }, this),\n                  modal: true,\n                  children: close => /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        href: \"#!\",\n                        style: {\n                          padding: '10px 80px 10px 0'\n                        },\n                        onClick: close,\n                        children: /*#__PURE__*/_jsxDEV(\"i\", {\n                          class: \"las la-times\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 409,\n                          columnNumber: 75\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 409,\n                        columnNumber: 9\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 409,\n                      columnNumber: 4\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: '#000000',\n                        textAlign: 'center',\n                        fontSize: '14px',\n                        fontWeight: 'bold',\n                        marginTop: '30px'\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          fontSize: '42px',\n                          fontWeight: 'bold'\n                        },\n                        children: /*#__PURE__*/_jsxDEV(\"i\", {\n                          class: \"las la-shipping-fast\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 410,\n                          columnNumber: 156\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 410,\n                        columnNumber: 107\n                      }, this), \"Your have successfully done\", /*#__PURE__*/_jsxDEV(\"p\", {\n                        style: {\n                          color: '#9AAAAE',\n                          padding: '20px 0 30px 0'\n                        },\n                        children: \"Your item is successfully booked\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 411,\n                        columnNumber: 5\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          padding: '0 40% 10% 40%'\n                        },\n                        children: /*#__PURE__*/_jsxDEV(\"a\", {\n                          href: \"/newsfeed\",\n                          className: \"buttonCnfirmShip\",\n                          children: \"Ok,Thanks\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 414,\n                          columnNumber: 44\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 414,\n                        columnNumber: 5\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 410,\n                      columnNumber: 5\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 408,\n                    columnNumber: 16\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 406,\n                  columnNumber: 2\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 404,\n                columnNumber: 7\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 18\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 379,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ShippingComponent, \"c0TV19D1zUpDwiI7aE8/xKMoa2c=\", false, function () {\n  return [useHistory];\n});\n\n_c = ShippingComponent;\nexport default ShippingComponent;\n\nvar _c;\n\n$RefreshReg$(_c, \"ShippingComponent\");","map":{"version":3,"sources":["/Users/mohammedshafeeq/Downloads/Shareup-Project-main/Shareup-react/shareup-react/src/components/Hang/ShippingComponent.jsx"],"names":["React","useState","useEffect","useContext","useCallback","useRef","Redirect","useHistory","Button","Form","UserService","UserContext","PostService","AuthService","SimpleReactLightbox","testScript","GoogleMapReact","EditPostComponent","Layout","PostComponent","Popup","PhoneInput","ShippingComponent","props","isLoading","setIsLoading","history","user","refresh","setRefresh","showComp","setShowComp","showLoc","setShowLoc","posts","setPosts","postsForUser","setPostsForUser","savedPost","setSavedPost","userR","setUserR","refMap","postContent","setPostContent","commentContent","setCommentContent","files","setFiles","postImage","setPostImage","showPostImage","setShowPostImage","uploadError","setUploadError","editPostId","setEditPostId","img","setImage","value","setValue","defaultProps","center","lat","lng","zoom","AnyReactComponent","text","getPost","then","res","data","getPostForUser","getCurrentUser","username","uniquePost","Array","from","Set","map","a","id","find","getSavedPost","getSavedPostForUser","handlePostContent","event","console","log","target","handleDeletePost","postid","deletePost","status","handleCommentContent","handlePostingComment","comment","content","addComment","handleEditPost","handleFile","reader","FileReader","onload","readyState","result","readAsDataURL","handleRemoveImage","handleEditingSave","checkIfLiked","post","reactions","filter","reaction","length","checkIfSaved","savedByUsers","userz","handleDeleteComment","commentid","deleteComment","getCommentCounter","comments","counter","replies","uploadPost","preventDefault","Object","keys","constructor","formData","FormData","append","createPost","JSON","stringify","handleLikePost","post_id","likePost","handleSavePost","savePost","getUser","getUserByEmail","testFanc","showMap","height","width","key","show","group","members","some","member","email","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","fontSize","textAlign","close","padding","color","fontWeight","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext,  useCallback, useRef} from 'react';\r\nimport { Redirect, useHistory } from \"react-router-dom\";\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport UserService from '../../services/UserService';\r\nimport UserContext from '../../contexts/UserContext';\r\nimport PostService from '../../services/PostService';\r\nimport AuthService from '../../services/auth.services';\r\nimport SimpleReactLightbox from 'simple-react-lightbox'\r\nimport { testScript } from '../../js/script';\r\nimport GoogleMapReact from 'google-map-react';\r\n\r\n\r\nimport EditPostComponent from '../post/EditPostComponent'\r\n\r\nimport Layout from '../LayoutComponent';\r\n\r\nimport PostComponent from '../post/PostComponent';\r\nimport Popup from 'reactjs-popup';\r\nimport PhoneInput from 'react-phone-number-input'\r\n\r\n\r\nfunction ShippingComponent(props)  {\r\n  \r\n\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  let history = useHistory();\r\n\r\n  const { user } = useContext(UserContext)\r\n\r\n  // const []\r\n\r\n  // const inputRef = createRef();\r\n\r\n  const [refresh, setRefresh] = useState(null)\r\n\r\n  const [showComp, setShowComp] = useState(\"newsfeed\");\r\n  const [showLoc, setShowLoc] = useState(\"yes\");\r\n  const [posts, setPosts] = useState([]);\r\n  const [postsForUser, setPostsForUser] = useState([]);\r\n  const [savedPost, setSavedPost] = useState([]);\r\n  const [userR, setUserR] = useState([]);\r\n  const refMap = useRef(null);\r\n\r\n\r\n\r\n  const [postContent, setPostContent] = useState(\"\");\r\n  const [commentContent, setCommentContent] = useState(\"\");\r\n  const [files, setFiles] = useState({});\r\n  const [postImage, setPostImage] = useState({});\r\n  const [showPostImage, setShowPostImage] = useState(false);\r\n\r\n  const [uploadError, setUploadError] = useState(\"\");\r\n\r\n\r\n\r\n  const [editPostId, setEditPostId] = useState(null)\r\n\r\n  const [img, setImage] = useState(\"\");\r\n  const [value, setValue] = useState();\r\n  \r\n  const defaultProps = {\r\n    center: {\r\n      lat: 10.99835602,\r\n      lng: 77.01502627\r\n    },\r\n    zoom: 11\r\n  };\r\n\r\n  \r\n  // const [cursorPosition, setCursorPosition] = useState();\r\n  // const pickEmoji = (e, {emoji}) => {\r\n  //   const ref = inputRef.current;\r\n  //   ref.focus();\r\n  //   const start = commentContent.substring(0, ref.seletionStart);\r\n  //   const end = commentContent.substring(ref.selectionStart);\r\n  //   const text = start + emoji + end;\r\n  //   setCommentContent(text)\r\n  //   setCursorPosition(start.length+emoji.length)\r\n  // }\r\n\r\n  // useEffect(() => {\r\n  //   inputRef.current.selectionEnd = cursorPosition;\r\n  // },[cursorPosition])\r\n  const AnyReactComponent = ({ text }) => <div>{text}</div>;\r\n\r\n  const getPost = async () => {\r\n    await PostService.getPost().then(res => {\r\n      setPosts(res.data)\r\n    })\r\n  }\r\n\r\n  const getPostForUser = async () => {\r\n    await PostService.getPostForUser(AuthService.getCurrentUser().username).then(res => {\r\n      const uniquePost = Array.from(new Set(res.data.map(a => a.id)))\r\n        .map(id => {\r\n          return res.data.find(a => a.id === id)\r\n        })\r\n      setPostsForUser(uniquePost)\r\n    })\r\n  }\r\n\r\n  const getSavedPost = async () => {\r\n    await PostService.getSavedPostForUser(AuthService.getCurrentUser().username).then(res => {\r\n      setSavedPost(res.data)\r\n    })\r\n  }\r\n\r\n  const handlePostContent = (event) => {\r\n    console.log(event.target.value)\r\n    setPostContent(event.target.value)\r\n  }\r\n\r\n  const handleDeletePost = (postid) => {\r\n    PostService.deletePost(postid).then(res => {\r\n      console.log(res.status)\r\n      setRefresh(res.data)\r\n      // window.location.reload();\r\n    })\r\n  }\r\n\r\n  const handleCommentContent = (event) => {\r\n    console.log(event.target.value)\r\n    setCommentContent(event.target.value)\r\n  }\r\n\r\n  const handlePostingComment = (postid) => {\r\n    if (commentContent === \"\") {\r\n      return null;\r\n    }\r\n    const comment = { content: commentContent }\r\n    PostService.addComment(user.id, postid, comment).then(res => {\r\n      console.log(res.status)\r\n      setRefresh(res.data)\r\n      setCommentContent(\"\")\r\n    })\r\n  }\r\n\r\n  const handleEditPost = (id) => {\r\n    setEditPostId(id)\r\n  }\r\n\r\n  const handleFile = (event) => {\r\n    console.log(event.target.files[0])\r\n    setFiles(event.target.files[0])\r\n    const reader = new FileReader();\r\n    reader.onload = () => {\r\n      if (reader.readyState === 2) {\r\n        setPostImage(reader.result)\r\n      }\r\n    }\r\n    console.log(event.target.files[0])\r\n    // if(event.target.files[0].type === blob){\r\n    reader.readAsDataURL(event.target.files[0])\r\n    // }\r\n    setShowPostImage(true)\r\n  }\r\n\r\n  const handleRemoveImage = () => {\r\n    setFiles({})\r\n    setShowPostImage(false)\r\n  }\r\n\r\n  const handleEditingSave = (value) => {\r\n    setEditPostId(value)\r\n    // console.log(res.status)\r\n    // window.location.reload();\r\n  }\r\n\r\n  const checkIfLiked = (post) => {\r\n    // maybe this is more effecient\r\n    // post.reactions.map(r => {\r\n    //   console.log(JSON.stringify(r.user))\r\n    //   if(r.user.id === user.id){\r\n    //     return true\r\n    //   }else{\r\n    //     return false\r\n    //   }\r\n    // })\r\n    const result = post.reactions.filter(reaction => reaction.user.id == userR.id)\r\n    if (result.length > 0) {\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n \r\n  const checkIfSaved = (post) => {\r\n    console.log(post.savedByUsers)\r\n    // maybe this is more effecient\r\n    // post.savedByUsers.map(r => {\r\n    //   console.log(\"runninggg\")\r\n    //   console.log(JSON.stringify(r.user) + \" i p pp p p\")\r\n    // if(r.user.id === user.id){\r\n    //   return true\r\n    // }else{\r\n    //   return false\r\n    // }\r\n    // })\r\n    console.log(post.savedByUsers.length + \" yaa\")\r\n    const result = post.savedByUsers.filter(userz => userz.id == user.id)\r\n    if (result.length > 0) {\r\n      console.log(\" FOUND\")\r\n      return true\r\n    }\r\n    console.log(\" Not found\")\r\n    return false\r\n  }\r\n\r\n  const handleDeleteComment = (commentid) => {\r\n    PostService.deleteComment(commentid).then(res => {\r\n      console.log(res.status)\r\n      setRefresh(res.data)\r\n    })\r\n  }\r\n\r\n  const getCommentCounter = (comments) => {\r\n    let counter = 0\r\n    comments.map(comment => {\r\n      counter += comment.replies.length + 1\r\n    })\r\n    return counter\r\n  }\r\n\r\n  const uploadPost = (event) => {\r\n    event.preventDefault();\r\n    setUploadError(\"\")\r\n    console.log(\"uploading post working\")\r\n    if (postContent === \"\" && (Object.keys(files).length === 0 && files.constructor === Object)) {\r\n      console.log(\"cant be null\")\r\n      setUploadError(\"Please Insert A Text or an Image\")\r\n      return\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('content', postContent)\r\n    console.log(\" this is the files\" + files)\r\n    formData.append(`files`, files)\r\n    PostService.createPost(user.id, formData).then(res => {\r\n      console.log(JSON.stringify(res))\r\n      setPostContent(\"\")\r\n      handleRemoveImage()\r\n      setRefresh(res.data)\r\n    })\r\n  }\r\n\r\n  const handleLikePost = async (post_id) => {\r\n    UserService.likePost(user.id, post_id).then(res => {\r\n      setRefresh(res.data)\r\n    })\r\n  }\r\n\r\n  const handleSavePost = async (post_id) => {\r\n    UserService.savePost(user.id, post_id).then(res => {\r\n      setRefresh(res.data)\r\n    })\r\n  }\r\n\r\n  const getUser = async () => {\r\n    if (user === null) {\r\n      console.log(\"RUNNING\")\r\n      await UserService.getUserByEmail(AuthService.getCurrentUser().username).then(res => {\r\n        setUserR(res.data);\r\n      })\r\n    } else {\r\n      console.log(\"WALKING\" + JSON.stringify(user))\r\n      setUserR(user)\r\n    }\r\n  }\r\n\r\n  const testFanc = (post) => {\r\n    return ( <PostComponent post={post} setRefresh={setRefresh}/>)\r\n  }\r\n  const showMap = () => {\r\n    if (showLoc === \"yes\"){\r\n    return (\r\n      <div style={{ height: '50vh', width: '100%' }}>\r\n<GoogleMapReact\r\n        bootstrapURLKeys={{ key: \"AIzaSyCUqRf-EB8vo-P_BYx0dRES5A3h78u1Xzc\" }}\r\n        defaultCenter={defaultProps.center}\r\n        defaultZoom={defaultProps.zoom}\r\n      >\r\n        <AnyReactComponent\r\n          lat={59.955413}\r\n          lng={30.337844}\r\n          text=\"My Marker\"\r\n        />\r\n      </GoogleMapReact>\r\n</div>\r\n    )\r\n  }\r\n  }\r\n  const show = () => {\r\n    if (showComp === \"newsfeed\") {\r\n      return (\r\n        <div className=\"loadMore\">\r\n          {\r\n            postsForUser.map(\r\n              post =>\r\n                <div key={post.id}>\r\n                  {\r\n                    post.group ?\r\n                      post.group.members.some(member => member.email === AuthService.getCurrentUser().username) ?\r\n                        testFanc(post) : null\r\n                      :\r\n                      testFanc(post)\r\n                  }\r\n                </div>\r\n            )\r\n          }\r\n\r\n        </div>\r\n      )\r\n    } else {\r\n      return (\r\n        <div className=\"loadMore\">\r\n          {\r\n            savedPost.map(\r\n              post =>\r\n                <div key={post.id}>\r\n                  {\r\n                    post.group ?\r\n                      post.group.members.some(member => member.email === AuthService.getCurrentUser().username) ?\r\n                        testFanc(post) : null\r\n                      :\r\n                      testFanc(post)\r\n                  }\r\n                </div>\r\n            )\r\n          }\r\n\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n\r\n//   useEffect(()=>{\r\n//     refMap.current.map.panTo(props.location)\r\n// },[props.location])\r\n\r\n  useEffect(() => {\r\n    getUser()\r\n    getPost().then(() => {\r\n      setIsLoading(false)\r\n    })\r\n    getPostForUser()\r\n    getSavedPost()\r\n    testScript()\r\n  }, [editPostId, refresh])\r\n\r\n  useEffect(() => {\r\n    getPostForUser()\r\n    getSavedPost()\r\n    testScript()\r\n  }, [user])\r\n  useEffect(() =>{\r\n    navigator.geolocation.getCurrentPosition(function(position) {\r\n      console.log(\"Latitude is :\", position.coords.latitude);\r\n      console.log(\"Longitude is :\", position.coords.longitude);\r\n    });\r\n  }\r\n  )\r\n  if (isLoading) {\r\n    return <div>Loading... Please Wait</div>\r\n  }\r\n\r\n  // const handleBoundsChanged = () => {\r\n  //   if (refMap.current) {\r\n  //       const mapCenter = {\r\n  //           lat: refMap.current.map.center.lat(),\r\n  //           lng: refMap.current.map.center.lng()\r\n  //       }\r\n  //       setListing({...listing, latLng: mapCenter})\r\n  //   }\r\n  // };\r\n  \r\n\r\n  return (\r\n    <Layout user={user}>\r\n    <div className=\"col-lg-6\">\r\n            <div className=\"central-meta newsfeed metaSip\">\r\n              \r\n                 <div className=\"new-postbox shipping\">\r\n                <h1>Location</h1>\r\n                <div className=\"newpst-input\">\r\n                  <Form>\r\n<p>Please provide your location</p>\r\n<p style={{fontSize:'12px'}}>So that we can deliver this item to your doorstep</p>\r\n\r\n\r\n\r\n<p>Share your location via google maps</p>\r\n{/* <a href=\"#\" className=\"openmap\" onClick={() => setShowLoc(\"yes\")}>Open map</a> */}\r\n{\r\n              showMap()\r\n            }\r\n\r\n    \r\n<div className=\"phno\">\r\n<PhoneInput\r\n      placeholder=\"Enter phone number\"\r\n      value={value}\r\n      onChange={setValue}/></div>\r\n      <div style={{textAlign:'center'}}>\r\n      \r\n <Popup  trigger={<a href=\"#\" className=\"buttonShip\">Let's Care it</a>} modal>\r\n                       {close => ( \r\n               <div>  \r\n   <div><a href=\"#!\" style={{padding:'10px 80px 10px 0'}} onClick={close}><i class=\"las la-times\"></i></a></div>\r\n    <div style={{ color:'#000000',textAlign:'center',fontSize:'14px',fontWeight:'bold',marginTop:'30px'}}><div style={{fontSize:'42px',fontWeight:'bold'}}><i class=\"las la-shipping-fast\"></i></div>Your have successfully done\r\n    <p style={{ color:'#9AAAAE',padding:'20px 0 30px 0'}}>Your item is successfully booked</p>\r\n    \r\n    \r\n    <div style={{padding:'0 40% 10% 40%'}}><a href=\"/newsfeed\" className=\"buttonCnfirmShip\">Ok,Thanks</a></div></div>\r\n    \r\n    \r\n\r\n   \r\n </div>  \r\n                  )}                 \r\n  </Popup> \r\n    \r\n\r\n      </div>\r\n\r\n                    {/* <textarea rows={2} placeholder={uploadError ? `${uploadError}` : \"We share,do you?\"} name=\"post_content\" value={postContent} onChange={handlePostContent} />\r\n                    {showPostImage ?\r\n                      <>\r\n                        <img id=\"preview\" src={postImage} style={{ width: \"80%\", border: \"3px solid\" }} />\r\n                        <button onClick={handleRemoveImage}>x</button>\r\n                      </>\r\n                      :\r\n                      null\r\n                    }\r\n\r\n                    <div className=\"attachments\">\r\n                      <ul>\r\n                      \r\n                        <li><Popup trigger={<span>Hang Share</span>} position=\"right center\">\r\n    <div className=\"headpop\">\r\n    <div style={{padding:'10px'}}><span><a href=\"#!\" style={{padding:'10px'}} ><i class=\"las la-times\"></i></a></span>\r\n    <span style={{ color:'#000000',fontSize:'14px'}}>Today to me, Tomorrow to you</span>\r\n    <span style={{float:'right'}}><a className=\"popup-btn\" href=\"#!\" >Keep Hang</a></span>\r\n    </div></div>\r\n    <div className=\"popupimg\"> \r\n    <img src={user ? user.profilePicturePath : userR.profilePicturePath} alt=\"\" /><span>{`${user.firstName} ${user.lastName}`}</span>\r\n                            </div>\r\n  </Popup> </li>\r\n\r\n                        <li><label className=\"fileContainer\"><img src=\"/assets/images/share-2.png\" alt=\"img\" /><span>Share Up</span> <input type=\"file\" name=\"post_image\" accept=\"image/*\" onChange={handleFile}></input>\r\n                        </label></li>\r\n                        <li><label className=\"fileContainer\"><i class=\"las la-sync\"></i><span>Swap</span> <input type=\"file\" name=\"post_video\" />\r\n                        </label></li>\r\n                        {/* <li><i class=\"las la-camera\"></i> <label className=\"fileContainer\"> <input type=\"file\" />\r\n                        </label></li> \r\n                        \r\n                          \r\n                       \r\n                      </ul>\r\n                      \r\n                    </div>\r\n                    <button style={{float: 'right',borderRadius:'20px'}} type=\"submit\" onClick={uploadPost}>Post</button> */}\r\n                  </Form>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            </div>\r\n            </Layout>\r\n           \r\n  );\r\n}\r\nexport default ShippingComponent;"]},"metadata":{},"sourceType":"module"}